model PublishedBook {
  id   String @id @default(nanoid(16))
  originalId String?

  title String @db.Citext

  contributor Contributor @relation(fields: [contributorId], references: [id], onDelete: Cascade)
  contributorId String

  mediaType MediaType @default(TEXT)

  chapters PublishedChapter[]
}

model PublishedChapter {
  id Int @default(autoincrement()) @id
  originalId String?
  originalMediaId String?

  book PublishedBook @relation(fields: [bookId], references: [id], onDelete: Cascade)
  bookId String

  title String @db.Citext
  text String
  number Int

  urls PublishedChapterMedia[]

  @@unique([bookId, number])
}

model PublishedChapterMedia {
  id Int @default(autoincrement()) @id

  source MediaSource
  format MediaFormat
  type MediaType

  bookChapter PublishedChapter @relation(fields: [bookChapterId], references: [id], onDelete: Cascade)
  bookChapterId Int

  url String
}